#!/bin/sh

if [ "$BASELINER_HOME" != "" ]; then
    cd $BASELINER_HOME
else
    BASEDIR=$(dirname $0)/..
    BASEDIR=`perl -MCwd -e 'print Cwd::realpath "$BASEDIR"'`
    export BASELINER_HOME=$BASEDIR
fi

export LIBPATH=$BASELINER_LIBPATH:$LIBPATH

if [ "$BALI_ENV" != "" ]; then
	export CATALYST_CONFIG_LOCAL_SUFFIX=$BALI_ENV
fi

if [ "$BASELINER_NLS_LANG" != "" ]; then
	export NLS_LANG=$BASELINER_NLS_LANG
fi

if [ "$BASELINER_SCRIPT" == "" ]; then
    export BASELINER_SCRIPT=script/bali.pl
fi

if [ "$BASELINER_LANG" != "" ]; then
	export LANG=$BASELINER_LANG
fi
# check if its a porcelain command
if [ -f "script/bali_$1.pl" ]; then
    export BASELINER_SCRIPT=script/bali_$1.pl
    shift
fi

cd $BASELINER_HOME
unset HTTP_PROXY
unset http_proxy

export BASELINER_SCRIPT=script/bali_rest.pl
bin/bali "$@"
